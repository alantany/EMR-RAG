论文的主要思路：
问题识别：传统的RAG系统在处理多文档时存在以下问题：
检索结果可能过于分散
难以捕捉文档间的关联信息
上下文信息的丢失
核心创新：
提出了一个两阶段的检索策略
第一阶段：文档级别的检索
第二阶段：段落级别的检索
引入了文档间的关联性分析
让我们基于这个思路改进代码：
主要改进点：
两阶段检索：
第一阶段先在文档级别进行检索，筛选出最相关的文档
第二阶段在选中的文档中进行更细粒度的段落检索
块间关联分析：
引入了get_cross_chunk_relevance函数计算文档块之间的关联度
在最终排序时综合考虑直接相关度和块间关联度
文档追踪：
添加了chunk_to_doc字典来追踪每个文档块的来源
在结果展示中显示文档块的所属文档
可视化改进：
分别展示两个阶段的检索结果
显示更详细的评分信息（直接相关度、块间关联度、最终得分）
这个实现更好地体现了论文的核心思想：
通过两阶段检索提高效率
考虑文档块之间的关联性
保持文档的上下文信息
您可以根据需要调整以下参数：
1. 第一阶段的top_k值
最终得分计算中的权重（当前是0.7和0.3）
文档分块的大小
这个实现提供了更好的多文档检索效果，同时保持了代码的可读性和可维护性。
